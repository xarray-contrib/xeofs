
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/1single/plot_eeof.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_1single_plot_eeof.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_1single_plot_eeof.py:


Extented EOF analysis
=====================

This example demonstrates Extended EOF (EEOF) analysis on ``xarray`` tutorial
data. EEOF analysis, also termed as Multivariate/Multichannel Singular
Spectrum Analysis, advances traditional EOF analysis to capture propagating
signals or oscillations in multivariate datasets. At its core, this
involves the formulation of a lagged covariance matrix that encapsulates
both spatial and temporal correlations. Subsequently, this matrix is
decomposed to yield its eigenvectors (components) and eigenvalues (explained variance).

Let's begin by setting up the required packages and fetching the data:

.. GENERATED FROM PYTHON SOURCE LINES 15-22

.. code-block:: Python


    import xarray as xr
    import xeofs as xe
    import matplotlib.pyplot as plt

    xr.set_options(display_expand_data=False)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <xarray.core.options.set_options object at 0x7ffac7efbc10>



.. GENERATED FROM PYTHON SOURCE LINES 23-24

Load the tutorial data.

.. GENERATED FROM PYTHON SOURCE LINES 24-27

.. code-block:: Python

    t2m = xr.tutorial.load_dataset("air_temperature").air









.. GENERATED FROM PYTHON SOURCE LINES 28-41

Prior to conducting the EEOF analysis, it's essential to determine the
structure of the lagged covariance matrix. This entails defining the time
delay ``tau`` and the ``embedding`` dimension. The former signifies the
interval between the original and lagged time series, while the latter
dictates the number of time-lagged copies in the delay-coordinate space,
representing the system's dynamics.
For illustration, using ``tau=4`` and ``embedding=40``, we generate 40
delayed versions of the time series, each offset by 4 time steps, resulting
in a maximum shift of ``tau x embedding = 160``. Given our dataset's
6-hour intervals, tau = 4 translates to a 24-hour shift.
It's obvious that this way of constructing the lagged covariance matrix
and subsequently decomposing it can be computationally expensive. For example,
given our dataset's dimensions,

.. GENERATED FROM PYTHON SOURCE LINES 41-44

.. code-block:: Python


    t2m.shape





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    (2920, 25, 53)



.. GENERATED FROM PYTHON SOURCE LINES 45-53

the extended dataset would have 40 x 25 x 53 = 53000 features
which is much larger than the original dataset's 1325 features.
To mitigate this, we can first preprocess the data using PCA / EOF analysis
and then perform EEOF analysis on the resulting PCA / EOF scores. Here,
we'll use ``n_pca_modes=50`` to retain the first 50 PCA modes, so we end
up with 40 x 50 = 200 (latent) features.
With these parameters set, we proceed to instantiate the ``ExtendedEOF``
model and fit our data.

.. GENERATED FROM PYTHON SOURCE LINES 53-62

.. code-block:: Python


    model = xe.models.ExtendedEOF(
        n_modes=10, tau=4, embedding=40, n_pca_modes=50, use_coslat=True
    )
    model.fit(t2m, dim="time")
    scores = model.scores()
    components = model.components()
    components






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;components&#x27; (mode: 10, embedding: 40, lat: 25, lon: 53)&gt; Size: 4MB
    0.0003854 0.0003646 0.000357 0.0003562 ... -0.001459 -0.00105 -0.0006424
    Coordinates:
      * lat        (lat) float32 100B 15.0 17.5 20.0 22.5 ... 67.5 70.0 72.5 75.0
      * lon        (lon) float32 212B 200.0 202.5 205.0 207.5 ... 325.0 327.5 330.0
      * embedding  (embedding) int64 320B 0 4 8 12 16 20 ... 136 140 144 148 152 156
      * mode       (mode) int64 80B 1 2 3 4 5 6 7 8 9 10
    Attributes: (12/16)
        model:          Extended EOF Analysis
        software:       xeofs
        version:        2.3.2
        date:           2024-03-31 20:34:10
        n_modes:        10
        center:         True
        ...             ...
        feature_name:   feature
        random_state:   None
        verbose:        False
        compute:        True
        solver:         auto
        solver_kwargs:  {}</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'components'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>mode</span>: 10</li><li><span class='xr-has-index'>embedding</span>: 40</li><li><span class='xr-has-index'>lat</span>: 25</li><li><span class='xr-has-index'>lon</span>: 53</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-68ccb7e4-d599-4c03-8acc-bb7504da4c36' class='xr-array-in' type='checkbox' ><label for='section-68ccb7e4-d599-4c03-8acc-bb7504da4c36' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0003854 0.0003646 0.000357 ... -0.001459 -0.00105 -0.0006424</span></div><div class='xr-array-data'><pre>array([[[[ 3.85377231e-04,  3.64587678e-04,  3.57022195e-04, ...,
               3.64273994e-04,  4.30024927e-04,  4.71222107e-04],
             [ 5.28396513e-04,  4.68930265e-04,  4.18565072e-04, ...,
               4.39861047e-04,  5.01968468e-04,  5.53940438e-04],
             [ 7.35368821e-04,  6.86607927e-04,  5.40704565e-04, ...,
               5.37312171e-04,  5.28872104e-04,  5.44873492e-04],
             ...,
             [ 4.54983311e-03,  4.73877863e-03,  4.90342652e-03, ...,
               4.28090138e-03,  4.13481698e-03,  3.84957843e-03],
             [ 4.01094689e-03,  4.04406271e-03,  4.09866915e-03, ...,
               3.91487419e-03,  3.95535050e-03,  3.91294717e-03],
             [ 4.04575698e-03,  4.03846223e-03,  4.05165302e-03, ...,
               3.57945336e-03,  3.62096210e-03,  3.66633864e-03]],

            [[ 3.90192079e-04,  3.70011735e-04,  3.63035623e-04, ...,
               3.83944708e-04,  4.50339243e-04,  4.92138362e-04],
             [ 5.35057692e-04,  4.75389528e-04,  4.25300274e-04, ...,
               4.58447979e-04,  5.22264912e-04,  5.75517468e-04],
             [ 7.43768805e-04,  6.93821965e-04,  5.47787284e-04, ...,
               5.55102560e-04,  5.47853031e-04,  5.65050273e-04],
    ...
             [ 4.02975290e-03,  3.84673130e-03,  3.46721501e-03, ...,
              -3.26710849e-03, -2.65009844e-03, -1.82510593e-03],
             [ 1.93284228e-03,  1.76090641e-03,  1.51546428e-03, ...,
              -2.94810291e-03, -2.51464380e-03, -1.87328278e-03],
             [ 2.09799805e-05, -5.48124335e-05, -1.53007867e-04, ...,
              -1.48722780e-03, -1.06971696e-03, -6.31904764e-04]],

            [[ 9.56107300e-06, -6.84668081e-05, -1.76010998e-04, ...,
               9.63267515e-04,  1.18530182e-03,  1.21708848e-03],
             [ 2.34545199e-04, -2.80128328e-05, -3.14295629e-04, ...,
               1.01695500e-03,  1.36913456e-03,  1.38354999e-03],
             [ 5.24092764e-04,  1.86360169e-04, -7.91789567e-06, ...,
               8.44319922e-04,  1.13797326e-03,  1.24660154e-03],
             ...,
             [ 4.97178676e-03,  4.83557439e-03,  4.48281936e-03, ...,
              -3.15007961e-03, -2.65495870e-03, -1.94909075e-03],
             [ 2.34224195e-03,  2.19245230e-03,  1.95396873e-03, ...,
              -2.80655790e-03, -2.44529668e-03, -1.89732180e-03],
             [-2.87983823e-05, -6.39298313e-05, -1.20089020e-04, ...,
              -1.45949846e-03, -1.04992392e-03, -6.42389978e-04]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-3f47d1b8-8cc5-4735-bde2-75c13bcf911d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3f47d1b8-8cc5-4735-bde2-75c13bcf911d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.0 17.5 20.0 ... 70.0 72.5 75.0</div><input id='attrs-1aaebebf-36ad-4474-833f-579098ef07aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1aaebebf-36ad-4474-833f-579098ef07aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1ee0734-ebb0-4116-aa0d-b8aa0a63a86e' class='xr-var-data-in' type='checkbox'><label for='data-e1ee0734-ebb0-4116-aa0d-b8aa0a63a86e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([15. , 17.5, 20. , 22.5, 25. , 27.5, 30. , 32.5, 35. , 37.5, 40. , 42.5,
           45. , 47.5, 50. , 52.5, 55. , 57.5, 60. , 62.5, 65. , 67.5, 70. , 72.5,
           75. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>200.0 202.5 205.0 ... 327.5 330.0</div><input id='attrs-45d38acf-fbe0-48f2-b4b3-fdf8dd7d5d34' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45d38acf-fbe0-48f2-b4b3-fdf8dd7d5d34' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97178b82-85a8-461f-b9da-8e9271105a78' class='xr-var-data-in' type='checkbox'><label for='data-97178b82-85a8-461f-b9da-8e9271105a78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,
           225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,
           250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,
           275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,
           300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,
           325. , 327.5, 330. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>embedding</span></div><div class='xr-var-dims'>(embedding)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 4 8 12 16 ... 140 144 148 152 156</div><input id='attrs-1b417e5f-6be8-4c83-b476-10cb43e83c6c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b417e5f-6be8-4c83-b476-10cb43e83c6c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa9080d3-004c-482b-813e-a6fac18b44fd' class='xr-var-data-in' type='checkbox'><label for='data-fa9080d3-004c-482b-813e-a6fac18b44fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   4,   8,  12,  16,  20,  24,  28,  32,  36,  40,  44,  48,  52,
            56,  60,  64,  68,  72,  76,  80,  84,  88,  92,  96, 100, 104, 108,
           112, 116, 120, 124, 128, 132, 136, 140, 144, 148, 152, 156])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>mode</span></div><div class='xr-var-dims'>(mode)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10</div><input id='attrs-be547667-009b-483f-904d-b8fd84df7393' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be547667-009b-483f-904d-b8fd84df7393' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-baac5f41-f561-4c6e-874e-c86534c842ab' class='xr-var-data-in' type='checkbox'><label for='data-baac5f41-f561-4c6e-874e-c86534c842ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af2e96cf-e92e-4f28-b4a4-dc3e11f2cc21' class='xr-section-summary-in' type='checkbox'  ><label for='section-af2e96cf-e92e-4f28-b4a4-dc3e11f2cc21' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>embedding</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-710c38ca-b0eb-43d1-809c-ae88e9f0ce43' class='xr-index-data-in' type='checkbox'/><label for='index-710c38ca-b0eb-43d1-809c-ae88e9f0ce43' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0,   4,   8,  12,  16,  20,  24,  28,  32,  36,  40,  44,  48,  52,
            56,  60,  64,  68,  72,  76,  80,  84,  88,  92,  96, 100, 104, 108,
           112, 116, 120, 124, 128, 132, 136, 140, 144, 148, 152, 156],
          dtype=&#x27;int64&#x27;, name=&#x27;embedding&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>mode</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-89bdf70a-2c7c-49c5-84dc-b098db79eb2e' class='xr-index-data-in' type='checkbox'/><label for='index-89bdf70a-2c7c-49c5-84dc-b098db79eb2e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], dtype=&#x27;int64&#x27;, name=&#x27;mode&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e3ba579e-f0e2-4a49-a59e-0944d2d4d93f' class='xr-index-data-in' type='checkbox'/><label for='index-e3ba579e-f0e2-4a49-a59e-0944d2d4d93f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([15.0, 17.5, 20.0, 22.5, 25.0, 27.5, 30.0, 32.5, 35.0, 37.5, 40.0, 42.5,
           45.0, 47.5, 50.0, 52.5, 55.0, 57.5, 60.0, 62.5, 65.0, 67.5, 70.0, 72.5,
           75.0],
          dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bbf9af6c-3307-49bb-8f48-a7b5b4c99f25' class='xr-index-data-in' type='checkbox'/><label for='index-bbf9af6c-3307-49bb-8f48-a7b5b4c99f25' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([200.0, 202.5, 205.0, 207.5, 210.0, 212.5, 215.0, 217.5, 220.0, 222.5,
           225.0, 227.5, 230.0, 232.5, 235.0, 237.5, 240.0, 242.5, 245.0, 247.5,
           250.0, 252.5, 255.0, 257.5, 260.0, 262.5, 265.0, 267.5, 270.0, 272.5,
           275.0, 277.5, 280.0, 282.5, 285.0, 287.5, 290.0, 292.5, 295.0, 297.5,
           300.0, 302.5, 305.0, 307.5, 310.0, 312.5, 315.0, 317.5, 320.0, 322.5,
           325.0, 327.5, 330.0],
          dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dd74e0a9-0f6d-4fd7-a215-3d99621066ef' class='xr-section-summary-in' type='checkbox'  ><label for='section-dd74e0a9-0f6d-4fd7-a215-3d99621066ef' class='xr-section-summary' >Attributes: <span>(16)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>model :</span></dt><dd>Extended EOF Analysis</dd><dt><span>software :</span></dt><dd>xeofs</dd><dt><span>version :</span></dt><dd>2.3.2</dd><dt><span>date :</span></dt><dd>2024-03-31 20:34:10</dd><dt><span>n_modes :</span></dt><dd>10</dd><dt><span>center :</span></dt><dd>True</dd><dt><span>standardize :</span></dt><dd>False</dd><dt><span>use_coslat :</span></dt><dd>True</dd><dt><span>check_nans :</span></dt><dd>True</dd><dt><span>sample_name :</span></dt><dd>sample</dd><dt><span>feature_name :</span></dt><dd>feature</dd><dt><span>random_state :</span></dt><dd>None</dd><dt><span>verbose :</span></dt><dd>False</dd><dt><span>compute :</span></dt><dd>True</dd><dt><span>solver :</span></dt><dd>auto</dd><dt><span>solver_kwargs :</span></dt><dd>{}</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 63-67

A notable distinction from standard EOF analysis is the incorporation of an
extra ``embedding`` dimension in the components. Nonetheless, the
overarching methodology mirrors traditional EOF practices. The results,
for instance, can be assessed by examining the explained variance ratio.

.. GENERATED FROM PYTHON SOURCE LINES 67-71

.. code-block:: Python


    model.explained_variance_ratio().plot()
    plt.show()




.. image-sg:: /auto_examples/1single/images/sphx_glr_plot_eeof_001.png
   :alt: plot eeof
   :srcset: /auto_examples/1single/images/sphx_glr_plot_eeof_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 72-73

Additionally, we can look into the scores; let's spotlight mode 4.

.. GENERATED FROM PYTHON SOURCE LINES 73-77

.. code-block:: Python


    scores.sel(mode=4).plot()
    plt.show()




.. image-sg:: /auto_examples/1single/images/sphx_glr_plot_eeof_002.png
   :alt: mode = 4
   :srcset: /auto_examples/1single/images/sphx_glr_plot_eeof_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 78-81

In wrapping up, we visualize the corresponding EEOF component of mode 4.
For visualization purposes, we'll focus on the component at a specific
latitude, in this instance, 60 degrees north.

.. GENERATED FROM PYTHON SOURCE LINES 81-84

.. code-block:: Python


    components.sel(mode=4, lat=60).plot()
    plt.show()



.. image-sg:: /auto_examples/1single/images/sphx_glr_plot_eeof_003.png
   :alt: lat = 60.0, mode = 4
   :srcset: /auto_examples/1single/images/sphx_glr_plot_eeof_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.777 seconds)


.. _sphx_glr_download_auto_examples_1single_plot_eeof.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_eeof.ipynb <plot_eeof.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_eeof.py <plot_eeof.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
